<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Advanced Selector Performance Benchmark</title>
    <style>
        /* Base Reset Approaches */
        #approach1 *, 
        #approach1 ::before, 
        #approach1 ::after {
            box-sizing: border-box;
        }

        #approach2 *, 
        #approach2 *::before, 
        #approach2 *::after {
            box-sizing: border-box;
        }

        /* Additional Complexity Layers */
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 0;
        }

        .dynamic-content {
            transition: all 0.3s ease;
        }

        .hover-effect:hover {
            transform: scale(1.05);
        }
    </style>
</head>
<body>
    <div id="app">
        <header>
            <h1>Performance Benchmark Site</h1>
            <nav>
                <ul id="main-nav"></ul>
            </nav>
        </header>

        <main>
            <div id="content-grid"></div>
        </main>

        <footer>
            <div id="performance-results"></div>
        </footer>
    </div>

    <script>
        // Utility to generate random content
        function generateRandomContent(count) {
            const contents = [
                'Lorem ipsum dolor sit amet',
                'Consectetur adipiscing elit',
                'Sed do eiusmod tempor incididunt',
                'Ut labore et dolore magna aliqua',
                'Excepteur sint occaecat cupidatat'
            ];

            return Array.from({ length: count }, () => {
                return {
                    title: contents[Math.floor(Math.random() * contents.length)],
                    description: contents[Math.floor(Math.random() * contents.length)],
                    id: Math.random().toString(36).substr(2, 9)
                };
            });
        }

        // Generate complex DOM structure
        function generateComplexDOM(approach) {
            const contentGrid = document.getElementById('content-grid');
            const mainNav = document.getElementById('main-nav');
            const content = generateRandomContent(500);

            // Create navigation
            content.slice(0, 10).forEach(item => {
                const li = document.createElement('li');
                li.className = `nav-item ${approach}-nav hover-effect`;
                li.innerHTML = `<a href="#${item.id}">${item.title}</a>`;
                mainNav.appendChild(li);
            });

            // Create content grid
            content.forEach(item => {
                const div = document.createElement('div');
                div.className = `content-item ${approach}-item dynamic-content hover-effect`;
                div.innerHTML = `
                    <h2>${item.title}</h2>
                    <p>${item.description}</p>
                    <div class="pseudo-element-test" data-id="${item.id}"></div>
                `;
                contentGrid.appendChild(div);
            });
        }

        // Performance Test Function
        function runPerformanceTest(approach, iterations = 10000) {
            const start = performance.now();
            
            for (let i = 0; i < iterations; i++) {
                // Complex selector scenarios
                const elements1 = document.querySelectorAll(
                    approach === 'approach1' 
                        ? '*, ::before, ::after' 
                        : '*, *::before, *::after'
                );
                
                const elements2 = document.querySelectorAll(`.${approach}-item`);
                const elements3 = document.querySelectorAll(`.${approach}-nav`);
                const elements4 = document.querySelectorAll('.dynamic-content');
                const elements5 = document.querySelectorAll('.hover-effect');
            }
            
            const end = performance.now();
            return end - start;
        }

        // Comprehensive Benchmark
        function runComprehensiveBenchmark() {
            const approaches = ['approach1', 'approach2'];
            const resultsContainer = document.getElementById('performance-results');

            approaches.forEach(approach => {
                // Reset DOM
                document.getElementById('content-grid').innerHTML = '';
                document.getElementById('main-nav').innerHTML = '';

                // Generate complex DOM
                generateComplexDOM(approach);

                const times = [];
                for (let i = 0; i < 10; i++) {
                    times.push(runPerformanceTest(approach));
                }

                const avg = times.reduce((a, b) => a + b, 0) / times.length;
                const min = Math.min(...times);
                const max = Math.max(...times);

                resultsContainer.innerHTML += `
                    <div class="result-section">
                        <h3>${approach} Results</h3>
                        <p>Average Time: ${avg.toFixed(4)} ms</p>
                        <p>Min Time: ${min.toFixed(4)} ms</p>
                        <p>Max Time: ${max.toFixed(4)} ms</p>
                        <details>
                            <summary>Detailed Timings</summary>
                            <pre>${JSON.stringify(times, null, 2)}</pre>
                        </details>
                    </div>
                `;
            });
        }

        // Initiate benchmark on page load
        window.onload = runComprehensiveBenchmark;
    </script>
</body>
</html>